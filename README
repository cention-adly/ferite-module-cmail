This is a refactored version of the mail module.

It is now more sane.